{
  "meta": {
    "version": "1.0.0",
    "name": "MATCH_SEED",
    "description": "Pattern matching as Mu projections for Phase 4 self-hosting",
    "doc": "docs/SelfHosting.v0.md",
    "invariants": [
      "All projections are pure Mu (JSON-compatible)",
      "No host recursion - kernel loop provides iteration",
      "Deterministic: same input -> same output",
      "Linear patterns only (no conflict detection)"
    ]
  },
  "projections": [
    {
      "id": "match.done",
      "description": "Focus null, stack empty -> match succeeded, return bindings",
      "pattern": {
        "mode": "match",
        "pattern_focus": null,
        "value_focus": null,
        "bindings": {"var": "b"},
        "stack": null
      },
      "body": {
        "mode": "match_done",
        "status": "success",
        "bindings": {"var": "b"}
      }
    },
    {
      "id": "match.sibling",
      "description": "After matching head, move to tail (sibling)",
      "pattern": {
        "mode": "match",
        "pattern_focus": null,
        "value_focus": null,
        "bindings": {"var": "b"},
        "stack": {
          "head": {
            "type": "pair",
            "pattern_rest": {"var": "pt"},
            "value_rest": {"var": "vt"}
          },
          "tail": {"var": "rest"}
        }
      },
      "body": {
        "mode": "match",
        "pattern_focus": {"var": "pt"},
        "value_focus": {"var": "vt"},
        "bindings": {"var": "b"},
        "stack": {"var": "rest"}
      }
    },
    {
      "id": "match.equal",
      "description": "Pattern equals value (non-linear: same var binds same value) - clears focus",
      "pattern": {
        "mode": "match",
        "pattern_focus": {"var": "same"},
        "value_focus": {"var": "same"},
        "bindings": {"var": "b"},
        "stack": {"var": "s"}
      },
      "body": {
        "mode": "match",
        "pattern_focus": null,
        "value_focus": null,
        "bindings": {"var": "b"},
        "stack": {"var": "s"}
      }
    },
    {
      "id": "match.var",
      "description": "Variable site binds to any value",
      "pattern": {
        "mode": "match",
        "pattern_focus": {"var": {"var": "name"}},
        "value_focus": {"var": "value"},
        "bindings": {"var": "bindings"},
        "stack": {"var": "stack"}
      },
      "body": {
        "mode": "match",
        "pattern_focus": null,
        "value_focus": null,
        "bindings": {
          "name": {"var": "name"},
          "value": {"var": "value"},
          "rest": {"var": "bindings"}
        },
        "stack": {"var": "stack"}
      }
    },
    {
      "id": "match.dict.descend",
      "description": "Descend into head/tail structure (both pattern and value)",
      "pattern": {
        "mode": "match",
        "pattern_focus": {"head": {"var": "ph"}, "tail": {"var": "pt"}},
        "value_focus": {"head": {"var": "vh"}, "tail": {"var": "vt"}},
        "bindings": {"var": "b"},
        "stack": {"var": "s"}
      },
      "body": {
        "mode": "match",
        "pattern_focus": {"var": "ph"},
        "value_focus": {"var": "vh"},
        "bindings": {"var": "b"},
        "stack": {
          "head": {
            "type": "pair",
            "pattern_rest": {"var": "pt"},
            "value_rest": {"var": "vt"}
          },
          "tail": {"var": "s"}
        }
      }
    },
    {
      "id": "match.wrap",
      "description": "Entry point - wrap raw match request into state (must be last)",
      "pattern": {
        "match": {
          "pattern": {"var": "p"},
          "value": {"var": "v"}
        }
      },
      "body": {
        "mode": "match",
        "pattern_focus": {"var": "p"},
        "value_focus": {"var": "v"},
        "bindings": null,
        "stack": null
      }
    }
  ]
}
